create or replace PROCEDURE PRU_TRI_SUMA AS

ESTADO_TRIGGER VARCHAR2(7);

BEGIN

    EXECUTE IMMEDIATE 'SELECT STATUS FROM USER_TRIGGERS WHERE TRIGGER_NAME = ' || CHR(39) || TO_CHAR('TRI_LOG') || CHR(39) || '' INTO ESTADO_TRIGGER;

    IF(ESTADO_TRIGGER = 'DISABLED') THEN

        EXECUTE IMMEDIATE 'ALTER TRIGGER TRI_LOG ENABLE;';        

    END IF;

    EXECUTE IMMEDIATE 'DELETE FROM SUMAEMPRESA';

    FOR TABLA IN (SELECT TABLE_NAME FROM USER_TABLES WHERE TABLE_NAME LIKE 'INVERSIONES_%')
    LOOP

        EXECUTE IMMEDIATE 'DELETE FROM ' || TABLA.TABLE_NAME || ''; 

    END LOOP;

    partir_tabla_invierte();

    FOR REGISTRO IN (SELECT * FROM SUMAEMPRESA)
    LOOP

         DBMS_output.put_line(REGISTRO.NOMBREE || ' ' || REGISTRO.CANTIDAD);

    END LOOP;

END;